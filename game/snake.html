<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Snake</title>
<style>
  body { margin:0; background:#0f1115; color:#e6e6e6; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; display:grid; place-items:center; height:100vh; }
  .wrap { text-align:center; }
  canvas { background:#111827; border:1px solid #2a3142; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35); }
  .row { margin-top:12px; color:#9aa3b2; font-size:14px; }
  .btn { margin-left:8px; padding:6px 10px; border-radius:10px; border:1px solid #384153; background:#171a23; color:#e6e6e6; cursor:pointer; }
</style>
</head>
<body>
<div class="wrap">
  <canvas id="c" width="420" height="420"></canvas>
  <div class="row">Arrow keys to move. Press <button class="btn" id="restart">R / Restart</button></div>
</div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const size = 20;
const tiles = canvas.width / size;

let snake, dir, apple, speed, alive, pendingDir, score;

function reset() {
  snake = [{x:10,y:10}];
  dir = {x:1,y:0};
  pendingDir = dir;
  placeApple();
  speed = 120;
  alive = true;
  score = 0;
}
function placeApple() {
  apple = {
    x: Math.floor(Math.random()*tiles),
    y: Math.floor(Math.random()*tiles)
  };
  // avoid spawning on snake
  if (snake.some(s => s.x===apple.x && s.y===apple.y)) placeApple();
}
function gameLoop(timestamp){
  if(!alive) return draw();
  if(!gameLoop.last) gameLoop.last = 0;
  if(timestamp - gameLoop.last < speed) { requestAnimationFrame(gameLoop); return; }
  gameLoop.last = timestamp;

  // apply turn if not reversing
  if ((pendingDir.x !== -dir.x) || (pendingDir.y !== -dir.y)) dir = pendingDir;

  const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

  // wrap around edges (change to death by walls if you prefer)
  if (head.x < 0) head.x = tiles-1;
  if (head.x >= tiles) head.x = 0;
  if (head.y < 0) head.y = tiles-1;
  if (head.y >= tiles) head.y = 0;

  // self collision
  if (snake.some(s => s.x===head.x && s.y===head.y)) {
    alive = false;
  } else {
    snake.unshift(head);
    if (head.x===apple.x && head.y===apple.y){
      score++;
      speed = Math.max(60, speed - 3);
      placeApple();
    } else {
      snake.pop();
    }
  }
  draw();
  requestAnimationFrame(gameLoop);
}
function draw(){
  ctx.fillStyle = '#0b1220';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // grid
  ctx.strokeStyle = 'rgba(255,255,255,0.05)';
  for(let i=0;i<=tiles;i++){
    ctx.beginPath(); ctx.moveTo(i*size,0); ctx.lineTo(i*size,canvas.height); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(0,i*size); ctx.lineTo(canvas.width,i*size); ctx.stroke();
  }

  // apple
  ctx.fillStyle = '#ef4444';
  ctx.fillRect(apple.x*size+2, apple.y*size+2, size-4, size-4);

  // snake
  ctx.fillStyle = '#5ee3a1';
  snake.forEach((s,i)=>{
    ctx.fillRect(s.x*size+2, s.y*size+2, size-4, size-4);
    if(i===0){ // eyes
      ctx.fillStyle = '#0b1220';
      ctx.fillRect(s.x*size+5, s.y*size+5, 3,3);
      ctx.fillRect(s.x*size+size-8, s.y*size+5, 3,3);
      ctx.fillStyle = '#5ee3a1';
    }
  });

  // score or game over
  ctx.fillStyle = '#e6e6e6';
  ctx.font = '16px ui-monospace, monospace';
  ctx.fillText('Score: '+score, 10, 20);

  if(!alive){
    ctx.fillStyle = 'rgba(0,0,0,0.5)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = '#e6e6e6';
    ctx.font = 'bold 22px system-ui, sans-serif';
    ctx.fillText('Game Over - Press R to restart', 30, canvas.height/2);
  }
}
addEventListener('keydown', e=>{
  if(e.key==='ArrowUp') pendingDir = {x:0,y:-1};
  else if(e.key==='ArrowDown') pendingDir = {x:0,y:1};
  else if(e.key==='ArrowLeft') pendingDir = {x:-1,y:0};
  else if(e.key==='ArrowRight') pendingDir = {x:1,y:0};
  else if(e.key.toLowerCase()==='r') { reset(); gameLoop.last=0; requestAnimationFrame(gameLoop); }
});
document.getElementById('restart').onclick = ()=>{ reset(); gameLoop.last=0; requestAnimationFrame(gameLoop); };

reset();
requestAnimationFrame(gameLoop);
</script>
</body>
</html>
