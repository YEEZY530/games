<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pong</title>
<style>
  body { margin:0; background:#0f1115; color:#e6e6e6; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; display:grid; place-items:center; height:100vh; }
  canvas { background:#111827; border:1px solid #2a3142; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35); }
  .hint { margin-top:10px; color:#9aa3b2; font-size:14px; text-align:center;}
</style>
</head>
<body>
  <div>
    <canvas id="c" width="640" height="400"></canvas>
    <div class="hint">Controls: W / S (left paddle). First to 7 wins.</div>
  </div>
<script>
const c = document.getElementById('c'), x = c.getContext('2d');
const W = c.width, H = c.height;

const PADDLE_H = 70, PADDLE_W = 10, BALL = 8;
let leftY = (H-PADDLE_H)/2, rightY = leftY;
let up=false, down=false;
let ball = { x: W/2, y: H/2, vx: 4, vy: 2 };
let score = { L:0, R:0 };
let paused = false;

addEventListener('keydown', e=>{
  if(e.key.toLowerCase()==='w') up=true;
  if(e.key.toLowerCase()==='s') down=true;
  if(e.key===' ') paused = !paused;
});
addEventListener('keyup', e=>{
  if(e.key.toLowerCase()==='w') up=false;
  if(e.key.toLowerCase()==='s') down=false;
});

function resetBall(servingLeft){
  ball.x = W/2; ball.y = H/2;
  const speed = 4 + Math.random()*2;
  const angle = (Math.random()*0.6 - 0.3); // small vertical angle
  ball.vx = (servingLeft? -1:1) * speed;
  ball.vy = speed*angle;
}

function step(){
  if(!paused){
    // move left paddle
    if(up) leftY -= 5;
    if(down) leftY += 5;
    leftY = Math.max(0, Math.min(H-PADDLE_H, leftY));

    // simple AI for right paddle
    const target = ball.y - PADDLE_H/2;
    rightY += Math.sign(target - rightY) * 4.2;
    rightY = Math.max(0, Math.min(H-PADDLE_H, rightY));

    // move ball
    ball.x += ball.vx;
    ball.y += ball.vy;

    // walls
    if(ball.y < BALL || ball.y > H-BALL) ball.vy *= -1;

    // paddles collisions
    // left
    if(ball.x - BALL < PADDLE_W+10 && ball.y > leftY && ball.y < leftY+PADDLE_H){
      ball.vx = Math.abs(ball.vx) + 0.3;
      const intersect = (ball.y - (leftY+PADDLE_H/2)) / (PADDLE_H/2);
      ball.vy = intersect * 4;
      ball.x = PADDLE_W+10 + BALL; // prevent sticking
    }
    // right
    if(ball.x + BALL > W-(PADDLE_W+10) && ball.y > rightY && ball.y < rightY+PADDLE_H){
      ball.vx = -Math.abs(ball.vx) - 0.3;
      const intersect = (ball.y - (rightY+PADDLE_H/2)) / (PADDLE_H/2);
      ball.vy = intersect * 4;
      ball.x = W-(PADDLE_W+10) - BALL;
    }

    // scoring
    if(ball.x < -BALL){
      score.R++; resetBall(true);
    } else if(ball.x > W+BALL){
      score.L++; resetBall(false);
    }
  }

  // draw
  x.fillStyle = '#0b1220'; x.fillRect(0,0,W,H);
  // mid line
  x.strokeStyle = 'rgba(255,255,255,.2)';
  x.setLineDash([6,10]); x.beginPath(); x.moveTo(W/2,0); x.lineTo(W/2,H); x.stroke(); x.setLineDash([]);

  // paddles
  x.fillStyle = '#5ee3a1';
  x.fillRect(10, leftY, PADDLE_W, PADDLE_H);
  x.fillRect(W-10-PADDLE_W, rightY, PADDLE_W, PADDLE_H);

  // ball
  x.fillStyle = '#e6e6e6';
  x.beginPath(); x.arc(ball.x, ball.y, BALL, 0, Math.PI*2); x.fill();

  // score
  x.fillStyle = '#e6e6e6';
  x.font = 'bold 24px system-ui, sans-serif';
  x.fillText(score.L, W/2-40, 30);
  x.fillText(score.R, W/2+28, 30);

  // win text
  if(score.L>=7 || score.R>=7){
    paused = true;
    x.fillStyle = 'rgba(0,0,0,.5)';
    x.fillRect(0,0,W,H);
    x.fillStyle = '#e6e6e6';
    x.font = 'bold 22px system-ui, sans-serif';
    x.fillText((score.L>score.R?'You win':'CPU wins')+' - press Space to play again', 80, H/2);
    if(!winShown){ winShown=true; }
  }
  requestAnimationFrame(step);
}
let winShown=false;
resetBall(Math.random()<0.5);
requestAnimationFrame(step);
</script>
</body>
</html>
